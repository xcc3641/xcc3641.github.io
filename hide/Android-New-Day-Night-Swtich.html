<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 一次 Android Day/Night 实践（夜间模式） · IM XIE</title><meta name="description" content="一次 Android Day/Night 实践（夜间模式） - 谢三弟"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="short icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://imxie.cc/atom.xml" title="IM XIE"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/xcc3641" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/WebLab/" target="_self" class="nav-list-link">WEBLAB</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">一次 Android Day/Night 实践（夜间模式）</h1><div class="post-info">2016年7月12日</div><div class="post-content"><p>用过 就看天气 的话，都会发现，它在 18：00 的时候会自动切换成夜间模式，当时使用的方法是在创建视图的时候就判断当前手机时间，再进行一些 UI 的改变。这样的做法不是特别的 cool ，无意之间发现 Android 23.2.0 的包下提供了 日/夜间 主题，所以立马就加入 就看天气 ，让我们来看看如何使用吧。</p>
<a id="more"></a>
<h4 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h4><p>首先你得先在你的 <code>style.xml</code>  文件里，把你的主题继承 DayNight 主题，像这样：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span></span></div><div class="line"><span class="tag">        <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.DayNight.DarkActionBar"</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="xml">        <span class="comment">&lt;!-- Customize your theme here. --&gt;</span></span></div><div class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></div><div class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></div><div class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure>
<p>它有四个可选值，分别是：</p>
<ul>
<li>MODE_NIGHT_NO： 使用亮色(light)主题，不使用夜间模式</li>
<li>MODE_NIGHT_YES：使用暗色(dark)主题，使用夜间模式</li>
<li>MODE_NIGHT_AUTO：根据当前时间自动切换 亮色(light)/暗色(dark)主题</li>
<li>MODE_NIGHT_FOLLOW_SYSTEM(默认选项)：设置为跟随系统，通常为 MODE_NIGHT_NO</li>
</ul>
<p>推荐在 Application 添加一个静态代码块来进行初始化全局设置：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">static</span> &#123;</div><div class="line">    AppCompatDelegate.setDefaultNightMode(</div><div class="line">        AppCompatDelegate.MODE_NIGHT_AUTO); <span class="comment">// 选择你需要的</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="切换主题时使用自定义资源"><a href="#切换主题时使用自定义资源" class="headerlink" title="切换主题时使用自定义资源"></a>切换主题时使用自定义资源</h4><p>使用自定义资源，只需要在 res 目录下创建对应的 values-night 文件夹并创建对应的 themes.xml 文件：</p>
<h5 id="res-values-colors-xml"><a href="#res-values-colors-xml" class="headerlink" title="res/values/colors.xml"></a>res/values/colors.xml</h5><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>#106c99<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>#0D4A6A<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>#FC413D<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div></pre></td></tr></table></figure>
<h5 id="res-values-night-colors-xml"><a href="#res-values-night-colors-xml" class="headerlink" title="res/values-night/colors.xml"></a>res/values-night/colors.xml</h5><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>#201D45<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>#201D45<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div></pre></td></tr></table></figure>
<p>同理其他资源你只需要在末尾添加 <code>-night</code> 系统就会自动加载对应的文件了。</p>
<hr>
<p><img src="http://ww2.sinaimg.cn/large/006tNbRwgw1f5umljz70uj30zo1iqn2z.jpg" alt=""></p>
<p><img src="http://ww1.sinaimg.cn/large/006tNbRwgw1f5umrv1sbpj30zo1iqjwv.jpg" alt=""></p>
<h4 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h4><ul>
<li><p><a href="http://www.androidpolice.com/2016/02/24/android-support-library-v23-2-adds-auto-switching-daynight-theme-support-for-vector-drawables-and-much-more/" target="_blank" rel="external">Android Support Library v23.2 Adds Auto-Switching Day/Night Theme, Support For Vector Drawables, And Much More</a></p>
</li>
<li><p><a href="https://kingideayou.github.io/2016/03/07/appcompat_23.2_day_night/" target="_blank" rel="external">AppCompat v23.2 - 夜间模式最佳实践</a></p>
</li>
</ul></div></article></div></section><footer><div class="paginator"></div><div data-thread-key="hide/Android-New-Day-Night-Swtich.html" data-title="一次 Android Day/Night 实践（夜间模式）" data-url="http://imxie.cc/hide/Android-New-Day-Night-Swtich.html" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"imxie"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://www.imxie.cc/js/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2014 - 2019 做一件值得的事.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-80145821-1",'auto');ga('send','pageview');</script></body></html>